{
#
#  /* 46 LDAP authentication */
#  /* user_source_ldap
#

    ### is going to move to action/init script
    use NethServer::Password;
    my $ldapPassword = NethServer::Password::store('sogo');
    ###

#   Conditional expnasion of LDAP UserSsoucres.
#   Supplemental to GNUStep setup, Please review  	
    if( ($smb{ServerRole} || "") eq 'ADS' ) {
        return '';
    }

    $OUT .= <<EOF
	
  /* 46 LDAP authentication */
    SOGoUserSources =(
     \{   
        id = groups;
        type = ldap;
        CNFieldName = cn;
        UIDFieldName = cn;
        IDFieldName = cn;
        baseDN = "ou=Groups,dc=directory,dc=nh";     
        bindDN = "cn=sogo,dc=directory,dc=nh";
        bindPassword = $ldapPassword;
        scope = ONE;
        canAuthenticate = YES;
        displayName = "{$SystemName} groups";
        hostname = "ldapi://";
        isAddressBook = NO;
     \},
     \{   
        id = users;
        type = ldap;
        CNFieldName = cn;
        UIDFieldName = uid;
        IDFieldName = uid;
        baseDN = "ou=People,dc=directory,dc=nh";
        bindDN = "cn=sogo,dc=directory,dc=nh";
        bindPassword = $ldapPassword;
        scope = ONE;
        filter = "accountStatus=active";
        canAuthenticate = YES;
        displayName = "{$SystemName} users";
        hostname = "ldapi://";
        isAddressBook = YES;
     \}
    );
EOF
}
